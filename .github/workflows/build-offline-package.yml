name: Build Offline Deployment Package

on:
  push:
    branches: [ main, master ]
  workflow_dispatch:

env:
  DOCKER_VERSION: "24.0.7"
  DOCKER_COMPOSE_VERSION: "2.24.0"
  CONTAINERD_VERSION: "1.7.11"

jobs:
  build-offline-package:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up environment variables
        run: |
          echo "BUILD_TIME=$(date -u +'%Y-%m-%dT%H:%M:%SZ')" >> $GITHUB_ENV
          echo "VERSION=$(git describe --tags --always || echo 'dev')" >> $GITHUB_ENV
          echo "GIT_COMMIT=$(git rev-parse --short HEAD)" >> $GITHUB_ENV

      - name: Set up Docker Buildx
        uses: docker/setup-buildx-action@v3

      - name: Build backend image
        run: |
          docker buildx build \
            --platform linux/amd64 \
            --build-arg VERSION=${{ env.VERSION }} \
            --build-arg BUILD_TIME=${{ env.BUILD_TIME }} \
            --build-arg GIT_COMMIT=${{ env.GIT_COMMIT }} \
            -t nta-server:v1.0.0 \
            --output type=docker,dest=/tmp/nta-server.tar \
            .

      - name: Build frontend image
        run: |
          docker buildx build \
            --platform linux/amd64 \
            -t nta-web:v1.0.0 \
            --output type=docker,dest=/tmp/nta-web.tar \
            ./web

      - name: Pull third-party images
        run: |
          docker pull --platform linux/amd64 postgres:15-alpine
          docker pull --platform linux/amd64 redis:7-alpine
          docker pull --platform linux/amd64 prom/prometheus:latest
          docker pull --platform linux/amd64 grafana/grafana:latest

      - name: Save third-party images
        run: |
          docker save postgres:15-alpine -o /tmp/postgres.tar
          docker save redis:7-alpine -o /tmp/redis.tar
          docker save prom/prometheus:latest -o /tmp/prometheus.tar
          docker save grafana/grafana:latest -o /tmp/grafana.tar

      - name: Download Docker offline packages
        run: |
          mkdir -p /tmp/docker-packages
          
          # Download Docker Engine for CentOS/AliyunOS
          curl -fsSL https://download.docker.com/linux/static/stable/x86_64/docker-${{ env.DOCKER_VERSION }}.tgz \
            -o /tmp/docker-packages/docker-${{ env.DOCKER_VERSION }}.tgz
          
          # Download Docker Compose
          curl -fsSL https://github.com/docker/compose/releases/download/v${{ env.DOCKER_COMPOSE_VERSION }}/docker-compose-linux-x86_64 \
            -o /tmp/docker-packages/docker-compose
          chmod +x /tmp/docker-packages/docker-compose
          
          # Download containerd
          curl -fsSL https://github.com/containerd/containerd/releases/download/v${{ env.CONTAINERD_VERSION }}/containerd-${{ env.CONTAINERD_VERSION }}-linux-amd64.tar.gz \
            -o /tmp/docker-packages/containerd.tar.gz

      - name: Create deployment scripts
        run: |
          mkdir -p /tmp/nta-deploy
          
          # Create install.sh
          cat > /tmp/nta-deploy/install.sh <<'INSTALL_EOF'
          #!/bin/bash
          set -e

          SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
          DOCKER_VERSION="24.0.7"
          COMPOSE_VERSION="2.24.0"

          # Color output
          RED='\033[0;31m'
          GREEN='\033[0;32m'
          YELLOW='\033[1;33m'
          NC='\033[0m'

          log_info() {
              echo -e "${GREEN}[INFO]${NC} $1"
          }

          log_warn() {
              echo -e "${YELLOW}[WARN]${NC} $1"
          }

          log_error() {
              echo -e "${RED}[ERROR]${NC} $1"
          }

          # Detect OS
          detect_os() {
              if [ -f /etc/os-release ]; then
                  . /etc/os-release
                  OS=$ID
                  VERSION_ID=$VERSION_ID
              else
                  log_error "Cannot detect OS"
                  exit 1
              fi
              
              log_info "Detected OS: $OS $VERSION_ID"
          }

          # Check system requirements
          check_requirements() {
              log_info "Checking system requirements..."
              
              # Check CPU cores
              CPU_CORES=$(nproc)
              if [ "$CPU_CORES" -lt 2 ]; then
                  log_warn "CPU cores: $CPU_CORES (recommended: >= 2)"
              else
                  log_info "CPU cores: $CPU_CORES âœ“"
              fi
              
              # Check memory
              TOTAL_MEM=$(free -g | awk '/^Mem:/{print $2}')
              if [ "$TOTAL_MEM" -lt 4 ]; then
                  log_warn "Memory: ${TOTAL_MEM}GB (recommended: >= 4GB)"
              else
                  log_info "Memory: ${TOTAL_MEM}GB âœ“"
              fi
              
              # Check disk space
              DISK_SPACE=$(df -BG "$SCRIPT_DIR" | tail -1 | awk '{print $4}' | sed 's/G//')
              if [ "$DISK_SPACE" -lt 50 ]; then
                  log_warn "Disk space: ${DISK_SPACE}GB (recommended: >= 50GB)"
              else
                  log_info "Disk space: ${DISK_SPACE}GB âœ“"
              fi
          }

          # Install Docker
          install_docker() {
              if command -v docker &> /dev/null; then
                  INSTALLED_VERSION=$(docker --version | grep -oP '\d+\.\d+\.\d+' | head -1)
                  log_info "Docker already installed: $INSTALLED_VERSION"
                  return 0
              fi
              
              log_info "Installing Docker $DOCKER_VERSION..."
              
              cd "$SCRIPT_DIR/docker-packages"
              tar xzf docker-${DOCKER_VERSION}.tgz
              
              # Copy binaries
              cp docker/* /usr/bin/
              
              # Create systemd service
              tee /etc/systemd/system/docker.service > /dev/null <<'DOCKER_SERVICE'
          [Unit]
          Description=Docker Application Container Engine
          Documentation=https://docs.docker.com
          After=network-online.target firewalld.service containerd.service docker.socket
          Wants=network-online.target
          Requires=docker.socket containerd.service

          [Service]
          Type=notify
          ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock
          ExecReload=/bin/kill -s HUP $MAINPID
          TimeoutSec=0
          RestartSec=2
          Restart=always
          StartLimitBurst=3
          StartLimitInterval=60s
          LimitNOFILE=infinity
          LimitNPROC=infinity
          LimitCORE=infinity
          TasksMax=infinity
          Delegate=yes
          KillMode=process

          [Install]
          WantedBy=multi-user.target
          DOCKER_SERVICE
              
              # Create docker socket
              tee /etc/systemd/system/docker.socket > /dev/null <<'DOCKER_SOCKET'
          [Unit]
          Description=Docker Socket for the API
          PartOf=docker.service

          [Socket]
          ListenStream=/var/run/docker.sock
          SocketMode=0660
          SocketUser=root
          SocketGroup=docker

          [Install]
          WantedBy=sockets.target
          DOCKER_SOCKET
              
              # Install containerd
              if ! command -v containerd &> /dev/null; then
                  log_info "Installing containerd..."
                  if [ -f "$SCRIPT_DIR/docker-packages/containerd.tar.gz" ]; then
                      tar -xz -C /usr/local -f "$SCRIPT_DIR/docker-packages/containerd.tar.gz"
                  else
                      log_error "containerd.tar.gz not found in docker-packages/"
                      exit 1
                  fi
                  
                  tee /etc/systemd/system/containerd.service > /dev/null <<'CONTAINERD_SERVICE'
          [Unit]
          Description=containerd container runtime
          Documentation=https://containerd.io
          After=network.target

          [Service]
          ExecStartPre=/sbin/modprobe overlay
          ExecStart=/usr/local/bin/containerd
          Restart=always
          RestartSec=5
          Delegate=yes
          KillMode=process
          OOMScoreAdjust=-999
          LimitNOFILE=1048576
          LimitNPROC=infinity
          LimitCORE=infinity
          TasksMax=infinity

          [Install]
          WantedBy=multi-user.target
          CONTAINERD_SERVICE
              fi
              
              # Create docker group
              if ! getent group docker > /dev/null 2>&1; then
                  log_info "Creating docker group..."
                  groupadd docker
              fi
              
              # Start services
              systemctl daemon-reload
              systemctl enable containerd docker.socket docker
              systemctl start containerd docker.socket docker
              
              log_info "Docker installed successfully âœ“"
          }

          # Install Docker Compose
          install_docker_compose() {
              if command -v docker-compose &> /dev/null; then
                  INSTALLED_VERSION=$(docker-compose --version | grep -oP '\d+\.\d+\.\d+' | head -1)
                  log_info "Docker Compose already installed: $INSTALLED_VERSION"
                  return 0
              fi
              
              log_info "Installing Docker Compose $COMPOSE_VERSION..."
              
              cp "$SCRIPT_DIR/docker-packages/docker-compose" /usr/local/bin/docker-compose
              chmod +x /usr/local/bin/docker-compose
              
              log_info "Docker Compose installed successfully âœ“"
          }

          # Load Docker images
          load_images() {
              log_info "Loading Docker images (this may take a few minutes)..."
              
              cd "$SCRIPT_DIR/images"
              for image in *.tar; do
                  log_info "Loading $image..."
                  docker load -i "$image"
              done
              
              log_info "All images loaded successfully âœ“"
          }

          # Configure firewall
          configure_firewall() {
              log_info "Configuring firewall..."
              
              if command -v firewall-cmd &> /dev/null; then
                  if systemctl is-active --quiet firewalld; then
                      firewall-cmd --permanent --add-port=80/tcp 2>/dev/null || log_warn "Failed to add port 80"
                      firewall-cmd --permanent --add-port=3000/tcp 2>/dev/null || log_warn "Failed to add port 3000"
                      firewall-cmd --permanent --add-port=9090/tcp 2>/dev/null || log_warn "Failed to add port 9090"
                      firewall-cmd --reload 2>/dev/null || log_warn "Failed to reload firewall"
                      log_info "Firewall configured (firewalld) âœ“"
                  else
                      log_warn "firewalld service is not running, skipping firewall configuration"
                  fi
              elif command -v ufw &> /dev/null; then
                  if systemctl is-active --quiet ufw 2>/dev/null || ufw status 2>/dev/null | grep -q "Status: active"; then
                      ufw allow 80/tcp 2>/dev/null || log_warn "Failed to add port 80"
                      ufw allow 3000/tcp 2>/dev/null || log_warn "Failed to add port 3000"
                      ufw allow 9090/tcp 2>/dev/null || log_warn "Failed to add port 9090"
                      log_info "Firewall configured (ufw) âœ“"
                  else
                      log_warn "ufw service is not active, skipping firewall configuration"
                  fi
              else
                  log_warn "No firewall detected, skipping"
              fi
          }

          # Create configuration
          create_config() {
              log_info "Creating configuration files..."
              
              mkdir -p "$SCRIPT_DIR/config"
              
              if [ ! -f "$SCRIPT_DIR/config/nta.yaml" ]; then
                  cp "$SCRIPT_DIR/config/nta.yaml.example" "$SCRIPT_DIR/config/nta.yaml"
                  log_info "Created config/nta.yaml (please review and modify)"
              fi
              
              # Generate random JWT secret
              JWT_SECRET=$(openssl rand -base64 32 2>/dev/null || cat /dev/urandom | tr -dc 'a-zA-Z0-9' | fold -w 32 | head -n 1)
              sed -i "s|CHANGE_THIS_SECRET_KEY_MIN_32_CHARACTERS_LONG|$JWT_SECRET|g" "$SCRIPT_DIR/config/nta.yaml"
              
              log_info "Configuration created âœ“"
          }

          # Deploy NTA
          deploy_nta() {
              log_info "Deploying NTA system..."
              
              cd "$SCRIPT_DIR"
              
              export VERSION="${VERSION:-dev}"
              export BUILD_TIME="${BUILD_TIME:-$(date -u +'%Y-%m-%dT%H:%M:%SZ')}"
              export GIT_COMMIT="${GIT_COMMIT:-unknown}"
              
              docker-compose up -d
              
              log_info "NTA deployed successfully âœ“"
          }

          # Check deployment
          check_deployment() {
              log_info "Checking deployment status..."
              
              sleep 5
              
              if curl -sf http://localhost/health > /dev/null 2>&1; then
                  log_info "NTA system is running âœ“"
                  echo ""
                  log_info "========================================="
                  log_info "  NTA System Deployed Successfully!"
                  log_info "========================================="
                  echo ""
                  log_info "Access URL: http://$(hostname -I | awk '{print $1}')/"
                  log_info "Default credentials: admin / admin"
                  echo ""
                  log_info "Grafana: http://$(hostname -I | awk '{print $1}'):3000"
                  log_info "Prometheus: http://$(hostname -I | awk '{print $1}'):9090"
                  echo ""
              else
                  log_error "NTA system health check failed"
                  log_info "Check logs with: docker-compose logs"
                  exit 1
              fi
          }

          # Main installation
          main() {
              echo ""
              log_info "========================================="
              log_info "  NTA Offline Installation"
              log_info "========================================="
              echo ""
              
              detect_os
              check_requirements
              install_docker
              install_docker_compose
              load_images
              configure_firewall
              create_config
              deploy_nta
              check_deployment
          }

          main "$@"
          INSTALL_EOF
          
          chmod +x /tmp/nta-deploy/install.sh

      - name: Create uninstall script
        run: |
          cat > /tmp/nta-deploy/uninstall.sh <<'UNINSTALL_EOF'
          #!/bin/bash
          set -e

          SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

          RED='\033[0;31m'
          YELLOW='\033[1;33m'
          NC='\033[0m'

          log_warn() {
              echo -e "${YELLOW}[WARN]${NC} $1"
          }

          log_error() {
              echo -e "${RED}[ERROR]${NC} $1"
          }

          echo ""
          log_warn "========================================="
          log_warn "  NTA Uninstallation"
          log_warn "========================================="
          echo ""
          log_warn "This will remove NTA system and all data!"
          read -p "Continue? (yes/no): " CONFIRM

          if [ "$CONFIRM" != "yes" ]; then
              log_error "Aborted"
              exit 1
          fi

          cd "$SCRIPT_DIR"

          log_warn "Stopping services..."
          docker-compose down -v

          log_warn "Removing images..."
          docker rmi nta-server:v1.0.0 nta-web:v1.0.0 postgres:15-alpine redis:7-alpine prom/prometheus:latest grafana/grafana:latest 2>/dev/null || true

          echo ""
          log_warn "NTA uninstalled. Docker and Docker Compose are still installed."
          log_warn "To remove Docker completely, run: sudo apt remove docker-ce docker-ce-cli (Ubuntu) or sudo yum remove docker-ce (CentOS)"
          UNINSTALL_EOF
          
          chmod +x /tmp/nta-deploy/uninstall.sh

      - name: Create README
        run: |
          cat > /tmp/nta-deploy/README.md <<'README_EOF'
          # NTA ç¦»çº¿éƒ¨ç½²åŒ…

          ## ç³»ç»Ÿè¦æ±‚

          - **æ“ä½œç³»ç»Ÿ**: CentOS 7+, Ubuntu 20.04+, Anolis OS 8
          - **æž¶æž„**: x86_64 (64ä½)
          - **CPU**: 2æ ¸åŠä»¥ä¸Š
          - **å†…å­˜**: 4GBåŠä»¥ä¸Š
          - **ç£ç›˜**: 50GBåŠä»¥ä¸Šå¯ç”¨ç©ºé—´

          ## éƒ¨ç½²æ­¥éª¤

          ### 1. è§£åŽ‹éƒ¨ç½²åŒ…
          ```bash
          unzip nta-offline-deploy-*.zip
          cd nta-offline-deploy
          ```

          ### 2. è¿è¡Œå®‰è£…è„šæœ¬
          ```bash
          sudo bash install.sh
          ```

          å®‰è£…è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
          - æ£€æµ‹ç³»ç»ŸçŽ¯å¢ƒ
          - å®‰è£… Docker å’Œ Docker Compose
          - åŠ è½½æ‰€æœ‰é•œåƒ
          - é…ç½®é˜²ç«å¢™
          - å¯åŠ¨ NTA ç³»ç»Ÿ

          ### 3. è®¿é—®ç³»ç»Ÿ
          ```
          å‰ç«¯: http://YOUR_SERVER_IP/
          Grafana: http://YOUR_SERVER_IP:3000
          Prometheus: http://YOUR_SERVER_IP:9090
          ```

          é»˜è®¤ç™»å½•è´¦å·: `admin` / `admin`

          ## å¸¸ç”¨å‘½ä»¤

          ### æŸ¥çœ‹æœåŠ¡çŠ¶æ€
          ```bash
          docker-compose ps
          ```

          ### æŸ¥çœ‹æ—¥å¿—
          ```bash
          docker-compose logs -f
          docker-compose logs -f nta-server
          ```

          ### é‡å¯æœåŠ¡
          ```bash
          docker-compose restart
          ```

          ### åœæ­¢æœåŠ¡
          ```bash
          docker-compose down
          ```

          ### å¯åŠ¨æœåŠ¡
          ```bash
          docker-compose up -d
          ```

          ## å¸è½½

          ```bash
          sudo bash uninstall.sh
          ```

          ## ç›®å½•ç»“æž„

          ```
          nta-offline-deploy/
          â”œâ”€â”€ install.sh              # å®‰è£…è„šæœ¬
          â”œâ”€â”€ uninstall.sh            # å¸è½½è„šæœ¬
          â”œâ”€â”€ docker-compose.yml      # Dockerç¼–æŽ’é…ç½®
          â”œâ”€â”€ images/                 # Dockeré•œåƒæ–‡ä»¶
          â”‚   â”œâ”€â”€ nta-server.tar
          â”‚   â”œâ”€â”€ nta-web.tar
          â”‚   â”œâ”€â”€ postgres.tar
          â”‚   â”œâ”€â”€ redis.tar
          â”‚   â”œâ”€â”€ prometheus.tar
          â”‚   â””â”€â”€ grafana.tar
          â”œâ”€â”€ docker-packages/        # Dockerç¦»çº¿å®‰è£…åŒ…
          â”‚   â”œâ”€â”€ docker-24.0.7.tgz
          â”‚   â””â”€â”€ docker-compose
          â”œâ”€â”€ config/                 # é…ç½®æ–‡ä»¶
          â”‚   â””â”€â”€ nta.yaml.example
          â”œâ”€â”€ deploy/                 # éƒ¨ç½²é…ç½®
          â””â”€â”€ README.md
          ```

          ## é…ç½®è¯´æ˜Ž

          ä¸»é…ç½®æ–‡ä»¶: `config/nta.yaml`

          **é‡è¦é…ç½®é¡¹**:
          - `server.host`: ç›‘å¬åœ°å€ (é»˜è®¤ 0.0.0.0)
          - `server.port`: ç›‘å¬ç«¯å£ (é»˜è®¤ 8080)
          - `database.dsn`: æ•°æ®åº“è¿žæŽ¥ä¸²
          - `security.jwt_secret`: JWTå¯†é’¥ (è‡ªåŠ¨ç”Ÿæˆ)

          ## æ•…éšœæŽ’æŸ¥

          ### æ£€æŸ¥å®¹å™¨çŠ¶æ€
          ```bash
          docker-compose ps
          ```

          ### æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
          ```bash
          docker-compose logs --tail=100
          ```

          ### å¥åº·æ£€æŸ¥
          ```bash
          curl http://localhost/health
          curl http://localhost/api/v1/health
          ```

          ### ç«¯å£æ£€æŸ¥
          ```bash
          netstat -tulnp | grep -E '80|8080|5432|6379'
          ```

          ## æŠ€æœ¯æ”¯æŒ

          - æ–‡æ¡£: `/root/NTA/docs/`
          - é—®é¢˜åé¦ˆ: GitHub Issues
          README_EOF

      - name: Copy deployment files
        run: |
          # Copy docker-compose.yml
          cp docker-compose.yml /tmp/nta-deploy/
          
          # Copy config files
          mkdir -p /tmp/nta-deploy/config
          cat > /tmp/nta-deploy/config/nta.yaml.example <<'CONFIG_EOF'
          server:
            host: 0.0.0.0
            port: 8080
            mode: release

          database:
            type: postgres
            dsn: "host=postgres user=nta password=nta_password dbname=nta port=5432 sslmode=disable"

          redis:
            addr: redis:6379
            password: ""
            db: 0

          security:
            jwt_secret: "CHANGE_THIS_SECRET_KEY_MIN_32_CHARACTERS_LONG"
            enable_tls: false
            rate_limit_requests: 100
            rate_limit_window: 60

          detection:
            scan:
              threshold: 20
              time_window: 300
              min_fail_rate: 0.6
            auth:
              fail_threshold: 5
              pth_window: 3600
            ml:
              enabled: true
              contamination: 0.01

          backup:
            enabled: true
            backup_dir: /app/backups
            interval_hours: 24
            retention_days: 7
          CONFIG_EOF
          
          # Copy deploy files
          mkdir -p /tmp/nta-deploy/deploy
          cp -r deploy/* /tmp/nta-deploy/deploy/ 2>/dev/null || true

      - name: Organize package structure
        run: |
          mkdir -p /tmp/nta-deploy/images
          mkdir -p /tmp/nta-deploy/docker-packages
          
          # Move images
          mv /tmp/nta-server.tar /tmp/nta-deploy/images/
          mv /tmp/nta-web.tar /tmp/nta-deploy/images/
          mv /tmp/postgres.tar /tmp/nta-deploy/images/
          mv /tmp/redis.tar /tmp/nta-deploy/images/
          mv /tmp/prometheus.tar /tmp/nta-deploy/images/
          mv /tmp/grafana.tar /tmp/nta-deploy/images/
          
          # Move docker packages
          mv /tmp/docker-packages/* /tmp/nta-deploy/docker-packages/

      - name: Create deployment package
        run: |
          cd /tmp
          PACKAGE_NAME="nta-offline-deploy-${{ env.VERSION }}-$(date +%Y%m%d)"
          mv nta-deploy "$PACKAGE_NAME"
          zip -r "${PACKAGE_NAME}.zip" "$PACKAGE_NAME"
          
          # Calculate checksum
          sha256sum "${PACKAGE_NAME}.zip" > "${PACKAGE_NAME}.zip.sha256"
          
          # Get package size
          PACKAGE_SIZE=$(du -h "${PACKAGE_NAME}.zip" | cut -f1)
          echo "PACKAGE_NAME=${PACKAGE_NAME}" >> $GITHUB_ENV
          echo "PACKAGE_SIZE=${PACKAGE_SIZE}" >> $GITHUB_ENV

      - name: Upload deployment package
        uses: actions/upload-artifact@v4
        with:
          name: ${{ env.PACKAGE_NAME }}
          path: |
            /tmp/${{ env.PACKAGE_NAME }}.zip
            /tmp/${{ env.PACKAGE_NAME }}.zip.sha256
          retention-days: 30

      - name: Generate deployment summary
        run: |
          cat >> $GITHUB_STEP_SUMMARY <<EOF
          ## ðŸŽ‰ NTA ç¦»çº¿éƒ¨ç½²åŒ…æž„å»ºå®Œæˆ

          ### ðŸ“¦ åŒ…ä¿¡æ¯
          - **ç‰ˆæœ¬**: ${{ env.VERSION }}
          - **æž„å»ºæ—¶é—´**: ${{ env.BUILD_TIME }}
          - **Git Commit**: ${{ env.GIT_COMMIT }}
          - **åŒ…å¤§å°**: ${{ env.PACKAGE_SIZE }}
          - **åŒ…åç§°**: ${{ env.PACKAGE_NAME }}.zip

          ### ðŸ“¥ ä¸‹è½½åœ°å€
          åœ¨ Artifacts ä¸­ä¸‹è½½: \`${{ env.PACKAGE_NAME }}\`

          ### ðŸš€ éƒ¨ç½²è¯´æ˜Ž

          1. ä¸‹è½½å¹¶è§£åŽ‹éƒ¨ç½²åŒ…
          \`\`\`bash
          unzip ${{ env.PACKAGE_NAME }}.zip
          cd ${{ env.PACKAGE_NAME }}
          \`\`\`

          2. è¿è¡Œå®‰è£…è„šæœ¬
          \`\`\`bash
          sudo bash install.sh
          \`\`\`

          3. è®¿é—®ç³»ç»Ÿ
          \`\`\`
          http://YOUR_SERVER_IP/
          \`\`\`

          ### ðŸ“‹ åŒ…å«å†…å®¹
          - âœ… Docker 24.0.7 ç¦»çº¿å®‰è£…åŒ…
          - âœ… Docker Compose 2.23.0
          - âœ… NTA åŽç«¯é•œåƒ (nta-server)
          - âœ… NTA å‰ç«¯é•œåƒ (nta-web)
          - âœ… PostgreSQL 15 é•œåƒ
          - âœ… Redis 7 é•œåƒ
          - âœ… Prometheus é•œåƒ
          - âœ… Grafana é•œåƒ
          - âœ… ä¸€é”®å®‰è£…è„šæœ¬
          - âœ… é…ç½®æ–‡ä»¶æ¨¡æ¿
          - âœ… éƒ¨ç½²æ–‡æ¡£

          ### ðŸ–¥ï¸ æ”¯æŒå¹³å°
          - CentOS 7+
          - Ubuntu 20.04+
          - Anolis OS (é¾™èœ¥) 8
          - x86_64 æž¶æž„

          ### ðŸ“Š ç³»ç»Ÿè¦æ±‚
          - CPU: 2æ ¸+
          - å†…å­˜: 4GB+
          - ç£ç›˜: 50GB+
          EOF