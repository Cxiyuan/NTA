server:
  host: 0.0.0.0
  port: 8080
  mode: release

zeek:
  log_dir: /var/lib/nta/zeek-logs
  script_dir: /opt/zeek/share/zeek/site
  interface: eth0

redis:
  addr: localhost:6379
  password: ""
  db: 0

database:
  type: postgres
  dsn: host=localhost user=nta password=nta_password dbname=nta port=5432 sslmode=disable

detection:
  scan:
    threshold: 20
    time_window: 300
    min_fail_rate: 0.6
  auth:
    fail_threshold: 5
    pth_window: 3600
  ml:
    enabled: true
    contamination: 0.01

threat_intel:
  sources:
    - name: threatfox
      url: https://threatfox-api.abuse.ch/api/v1/
      api_key: "61bed05600698d560b673f827be792ae32cf51b5806a84e0"
      enabled: true
    - name: alienvault_otx
      url: https://otx.alienvault.com/api/v1/
      api_key: "2ae1cf29a01ff74dd7cd3a71d97058a7568868698fb6f5ba5e0ae1802c44f7a4"
      enabled: true
  update_interval: 3600
  local_feed_path: /opt/nta/config/threat_feed.json

license:
  license_file: /opt/nta/config/license.key
  public_key_file: /opt/nta/config/public.pem

security:
  jwt_secret: CHANGE_THIS_SECRET_KEY_MIN_32_CHARACTERS_LONG
  enable_tls: false
  tls_cert_file: ""
  tls_key_file: ""
  rate_limit_requests: 100
  rate_limit_window: 60
  allowed_origins:
    - "*"

backup:
  enabled: false
  backup_dir: /var/lib/nta/backups
  interval_hours: 24
  retention_days: 7
