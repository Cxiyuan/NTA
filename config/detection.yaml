detection:
  scan:
    threshold: 20
    time_window: 300
    port_scan_threshold: 10
    min_fail_rate: 0.6
    port_diversity_threshold: 2.5
    sensitive_ports:
      - 135   # RPC
      - 139   # NetBIOS
      - 445   # SMB
      - 3389  # RDP
      - 22    # SSH
      - 5985  # WinRM HTTP
      - 5986  # WinRM HTTPS
  
  authentication:
    fail_threshold: 5
    time_window: 300
    pth_window: 3600
    monitor_protocols:
      - SMB
      - RDP
      - SSH
      - Kerberos
  
  execution:
    psexec_indicators:
      - "\\ADMIN$"
      - "\\C$"
      - "\\IPC$"
      - "\\pipe\\svcctl"
      - "\\pipe\\atsvc"
    
    wmi_endpoints:
      - "IWbemServices"
      - "IWbemLevel1Login"
      - "ISystemActivator"
      - "IRemUnknown2"
    
    suspicious_times:
      start_hour: 22
      end_hour: 6

network:
  internal_networks:
    - "10.0.0.0/8"
    - "172.16.0.0/12"
    - "192.168.0.0/16"
  
  excluded_hosts:
    - "192.168.1.1"
    - "10.0.0.1"
  
  whitelist:
    enabled: true
    monitoring_systems:
      - "192.168.1.100"  # Zabbix
      - "192.168.1.101"  # Nagios
    admin_workstations:
      - "10.0.10.0/24"
    automation_servers:
      - "10.0.20.0/24"

alerting:
  severity_levels:
    CRITICAL:
      - PASS_THE_HASH
      - PSEXEC
      - WMI_EXECUTION
      - SMB_BRUTEFORCE
      - RDP_BRUTEFORCE
    HIGH:
      - LATERAL_SCAN
      - RDP_HOPPING
      - KERBEROS_GOLDEN_TICKET
    MEDIUM:
      - LATERAL_AUTH_ANOMALY
      - SUSPICIOUS_TIME_ACCESS
  
  output:
    console: true
    syslog: false
    json_file: "/var/log/zeek/lateral_alerts.json"
    elastic:
      enabled: false
      host: "localhost"
      port: 9200
      index: "lateral-movement"

logging:
  zeek_log_dir: "/var/log/zeek"
  retention_days: 30
  rotation_interval: "1 day"

performance:
  max_tracked_hosts: 100000
  cleanup_interval: 3600
  memory_limit_mb: 2048

ml_model:
  enabled: true
  training_interval: "7 days"
  contamination: 0.01
  model_file: "/var/log/zeek/ml_model.pkl"
  baseline_file: "/var/log/zeek/baseline.json"

threat_intelligence:
  enabled: true
  cache_ttl_hours: 24
  feeds:
    - name: "abuse.ch"
      url: "https://threatfox.abuse.ch/export/json/recent/"
      enabled: false
    - name: "local_blacklist"
      enabled: true
  
decision_engine:
  thresholds:
    auto_block: 0.9999
    urgent_alert: 0.99
    high_alert: 0.95
    normal_alert: 0.90
    monitor: 0.80
  
  business_rules:
    vip_hosts:
      - "10.0.1.1"  # CEO workstation
      - "10.0.2.1"  # CFO workstation
    critical_servers:
      - "10.0.3.1"  # Domain Controller
      - "10.0.3.2"  # Database Server
    off_hours_multiplier: 1.15
    repeat_offender_multiplier: 1.2